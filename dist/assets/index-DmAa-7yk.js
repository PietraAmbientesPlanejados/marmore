import{r as z,a as ft,R as gt}from"./react-vendor-wGySg1uH.js";(function(){const h=document.createElement("link").relList;if(h&&h.supports&&h.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))u(f);new MutationObserver(f=>{for(const d of f)if(d.type==="childList")for(const l of d.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&u(l)}).observe(document,{childList:!0,subtree:!0});function b(f){const d={};return f.integrity&&(d.integrity=f.integrity),f.referrerPolicy&&(d.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?d.credentials="include":f.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function u(f){if(f.ep)return;f.ep=!0;const d=b(f);fetch(f.href,d)}})();var nt={exports:{}},Le={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vt=z,jt=Symbol.for("react.element"),Nt=Symbol.for("react.fragment"),yt=Object.prototype.hasOwnProperty,Ct=vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wt={key:!0,ref:!0,__self:!0,__source:!0};function it(s,h,b){var u,f={},d=null,l=null;b!==void 0&&(d=""+b),h.key!==void 0&&(d=""+h.key),h.ref!==void 0&&(l=h.ref);for(u in h)yt.call(h,u)&&!wt.hasOwnProperty(u)&&(f[u]=h[u]);if(s&&s.defaultProps)for(u in h=s.defaultProps,h)f[u]===void 0&&(f[u]=h[u]);return{$$typeof:jt,type:s,key:d,ref:l,props:f,_owner:Ct.current}}Le.Fragment=Nt;Le.jsx=it;Le.jsxs=it;nt.exports=Le;var e=nt.exports,Ve={},rt=ft;Ve.createRoot=rt.createRoot,Ve.hydrateRoot=rt.hydrateRoot;const St="pietra2025",ee={MATERIAIS:"pietra_materiais",ORCAMENTOS:"pietra_orcamentos",PRECOS:"pietra_precos",LOGADO:"pietra_logado"},He={polimento:22,esquadria:35,boleado:15,canal:15,pia:100,cubaEsculpida:630,cooktop:150,recorte:60,pes:200},Pt=4,Ke={getMateriais:()=>{try{const s=localStorage.getItem(ee.MATERIAIS);return s?JSON.parse(s):[]}catch(s){return console.error("Erro ao carregar materiais:",s),[]}},setMateriais:s=>{try{localStorage.setItem(ee.MATERIAIS,JSON.stringify(s))}catch(h){console.error("Erro ao salvar materiais:",h)}},getOrcamentos:()=>{try{const s=localStorage.getItem(ee.ORCAMENTOS);return s?JSON.parse(s):[]}catch(s){return console.error("Erro ao carregar or√ßamentos:",s),[]}},setOrcamentos:s=>{try{localStorage.setItem(ee.ORCAMENTOS,JSON.stringify(s))}catch(h){console.error("Erro ao salvar or√ßamentos:",h)}},getPrecos:()=>{try{const s=localStorage.getItem(ee.PRECOS);return s?JSON.parse(s):He}catch(s){return console.error("Erro ao carregar pre√ßos:",s),He}},setPrecos:s=>{try{localStorage.setItem(ee.PRECOS,JSON.stringify(s))}catch(h){console.error("Erro ao salvar pre√ßos:",h)}},isLogado:()=>localStorage.getItem(ee.LOGADO)==="true",setLogado:s=>{localStorage.setItem(ee.LOGADO,s?"true":"false")},logout:()=>{localStorage.removeItem(ee.LOGADO)}},kt=({aoEntrar:s})=>{const[h,b]=z.useState(""),[u,f]=z.useState(!1),[d,l]=z.useState(0),[j,m]=z.useState(!1),[O,M]=z.useState(0);z.useEffect(()=>{let y;return j&&O>0&&(y=setTimeout(()=>M(g=>g-1),1e3)),O===0&&j&&(m(!1),l(0)),()=>clearTimeout(y)},[j,O]);const a=()=>{if(!(j||!h))if(h===St)Ke.setLogado(!0),s();else{const y=d+1;l(y),f(!0),b(""),setTimeout(()=>f(!1),2500),y>=5&&(m(!0),M(30))}};return e.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #1e293b 0%, #0f172a 50%, #1e1b4b 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",fontFamily:"system-ui, sans-serif"},children:e.jsxs("div",{style:{width:"100%",maxWidth:"380px"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"24px"},children:e.jsx("div",{style:{width:"80px",height:"80px",background:"linear-gradient(135deg, #3b82f6, #2563eb)",borderRadius:"20px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 10px 40px rgba(59,130,246,0.3)",fontSize:"38px"},children:"‚äû"})}),e.jsx("h1",{style:{color:"#fff",fontSize:"28px",fontWeight:"bold",textAlign:"center",margin:"0 0 4px 0"},children:"Pietra Ambientes"}),e.jsx("p",{style:{color:"#94a3b8",textAlign:"center",margin:"0 0 32px 0",fontSize:"14px"},children:"Sistema de Or√ßamentos"}),e.jsxs("div",{style:{background:"#1e293b",borderRadius:"20px",border:"1px solid #334155",padding:"32px",boxShadow:"0 25px 50px rgba(0,0,0,0.4)"},children:[e.jsx("label",{style:{display:"block",color:"#cbd5e1",fontSize:"13px",fontWeight:"600",marginBottom:"8px"},children:"Senha de Acesso"}),e.jsx("input",{type:"password",value:h,onChange:y=>b(y.target.value),onKeyDown:y=>{y.key==="Enter"&&a()},placeholder:j?`Bloqueado... ${O}s`:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",disabled:j,autoFocus:!0,style:{width:"100%",padding:"12px 16px",borderRadius:"12px",border:u?"2px solid #ef4444":"1px solid #475569",background:j?"#1e293b":"#334155",color:"#fff",fontSize:"16px",outline:"none",boxSizing:"border-box",cursor:j?"not-allowed":"text",transition:"border 0.2s"}}),u&&e.jsxs("p",{style:{color:"#f87171",fontSize:"13px",marginTop:"8px",margin:"8px 0 0 0"},children:["‚ö†Ô∏è Senha incorreta. Tentativas restantes: ",5-d]}),j&&e.jsxs("p",{style:{color:"#fbbf24",fontSize:"13px",marginTop:"8px",margin:"8px 0 0 0"},children:["üîí Bloqueado por tentativas. Aguarde ",O,"s"]}),e.jsx("button",{onClick:a,disabled:j||!h,style:{width:"100%",marginTop:"24px",padding:"13px",borderRadius:"12px",border:"none",background:j||!h?"#475569":"linear-gradient(135deg, #3b82f6, #2563eb)",color:"#fff",fontSize:"15px",fontWeight:"700",cursor:j||!h?"not-allowed":"pointer",boxShadow:j||!h?"none":"0 4px 15px rgba(59,130,246,0.4)",transition:"all 0.2s"},children:j?"üîí Bloqueado":"Entrar"})]}),e.jsx("p",{style:{color:"#475569",textAlign:"center",fontSize:"12px",marginTop:"20px"},children:"Acesso restrito ¬∑ Fale com o administrador para obter a senha"})]})})},G=s=>"R$ "+Number(s).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),Mt=s=>s/1e6,Qe=(s,h)=>Mt(s*h),Et=(s,h,b)=>{if(!s||!h)return{area:0,custoMaterial:0,acabamentos:0,recortes:0,total:0,detalhesAcabamentos:[],detalhesRecortes:[]};const u=s.rotacao===90?s.altura:s.comprimento,f=s.rotacao===90?s.comprimento:s.altura,d=Qe(u,f),l=d*(h.venda||h.custo);let j=0;const m=[];s.acabamentos&&["esquadria","boleado","polimento","canal"].forEach(a=>{const y=s.acabamentos[a];if(y&&y.ativo){let g=0;const n=y.lados;if(n.superior&&(g+=u),n.inferior&&(g+=u),n.esquerda&&(g+=f),n.direita&&(g+=f),g>0){const I=g/1e3,w=I*b[a];j+=w,m.push({tipo:a,metros:I.toFixed(2),valor:w})}}});let O=0;const M=[];if(s.cuba&&s.cuba>0){const a=s.cuba*b.pia;O+=a,M.push({tipo:"Cuba",quantidade:s.cuba,valor:a})}if(s.cubaEsculpida&&s.cubaEsculpida>0){const a=s.cubaEsculpida*b.cubaEsculpida;O+=a,M.push({tipo:"Cuba Esculpida",quantidade:s.cubaEsculpida,valor:a})}if(s.cooktop&&s.cooktop>0){const a=s.cooktop*b.cooktop;O+=a,M.push({tipo:"Cooktop",quantidade:s.cooktop,valor:a})}if(s.recorte&&s.recorte>0){const a=s.recorte*b.recorte;O+=a,M.push({tipo:"Recorte",quantidade:s.recorte,valor:a})}if(s.pes&&s.pes>0){const a=s.pes*b.pes;O+=a,M.push({tipo:"P√©s",quantidade:s.pes,valor:a})}return{area:d,custoMaterial:l,acabamentos:j,recortes:O,total:l+j+O,detalhesAcabamentos:m,detalhesRecortes:M}},At=(s,h)=>{const b=s.ambientes.flatMap(j=>j.pecas),u=[],f=Pt,d={};b.forEach(j=>{d[j.materialId]||(d[j.materialId]=[]),d[j.materialId].push(j)}),Object.keys(d).forEach(j=>{const m=h.find(M=>M.id===parseInt(j));if(!m)return;d[j].forEach(M=>{let a=!1;for(let y of u.filter(g=>g.materialId===parseInt(j))){const g=Ot(y,M,m,f);if(g){M.chapaId=y.id,M.posX=g.x,M.posY=g.y,y.pecas.push(M),a=!0;break}}if(!a){const y={id:Date.now()+Math.random(),materialId:parseInt(j),material:m,pecas:[]};M.chapaId=y.id,M.posX=f,M.posY=f,y.pecas.push(M),u.push(y)}})});const l=s.ambientes.map(j=>({...j,pecas:j.pecas.map(m=>b.find(M=>M.id===m.id)||m)}));return{...s,chapas:u,ambientes:l}},Ot=(s,h,b,u)=>{const f=b.comprimento,d=b.altura,l=h.rotacao===90?h.altura:h.comprimento,j=h.rotacao===90?h.comprimento:h.altura;for(let m=u;m+j+u<=d;m+=5)for(let O=u;O+l+u<=f;O+=5)if(!s.pecas.some(a=>{const y=a.rotacao===90?a.altura:a.comprimento,g=a.rotacao===90?a.comprimento:a.altura,n=Math.abs(O+l/2-(a.posX+y/2)),I=Math.abs(m+j/2-(a.posY+g/2)),w=(l+y)/2+u,r=(j+g)/2+u;return n<w&&I<r}))return{x:O,y:m};return null},ct=(s,h,b)=>{if(!s)return{custoChapas:0,vendaChapas:0,margemChapas:0,acabamentos:0,recortes:0,custoTotal:0,vendaTotal:0,margemTotal:0,chapasPorMaterial:{},detalhesAcabamentos:[],detalhesRecortes:[]};let u=0,f=0;const d={},l=[];s.chapas.forEach(I=>{const w=h.find(c=>c.id===I.materialId);if(!w)return;const r=I.materialId;d[r]=(d[r]||0)+1;const D=Qe(w.comprimento,w.altura);let S=0;I.pecas.forEach(c=>{const $=c.rotacao===90?c.altura:c.comprimento,P=c.rotacao===90?c.comprimento:c.altura;S+=Qe($,P)});const E=D-S,q=S*(w.venda||w.custo),v=E*w.custo,N=S*w.custo;f+=q+v,u+=N+v,l.push({chapaId:I.id,materialId:w.id,materialNome:w.nome,areaTotal:D,areaPecas:S,areaSobra:E,custoSobra:v,custoPecas:N,vendaPecas:q,percentualAproveitamento:S/D*100})});let j=0,m=0;const O=[],M=[];s.ambientes.forEach((I,w)=>{I.pecas.forEach((r,D)=>{const S=r.nome||`${I.nome} - Pe√ßa #${D+1}`;if(r.acabamentos){const E=r.rotacao===90?r.altura:r.comprimento,q=r.rotacao===90?r.comprimento:r.altura;if(r.acabamentos.esquadria&&r.acabamentos.esquadria.ativo){let v=0;const N=r.acabamentos.esquadria.lados;if(N.superior&&(v+=E),N.inferior&&(v+=E),N.esquerda&&(v+=q),N.direita&&(v+=q),v>0){const c=v/1e3*b.esquadria;j+=c,O.push({tipo:"Esquadria",peca:S,medida:`${v}mm`,valor:c})}}if(r.acabamentos.boleado&&r.acabamentos.boleado.ativo){let v=0;const N=r.acabamentos.boleado.lados;if(N.superior&&(v+=E),N.inferior&&(v+=E),N.esquerda&&(v+=q),N.direita&&(v+=q),v>0){const c=v/1e3*b.boleado;j+=c,O.push({tipo:"Boleado",peca:S,medida:`${v}mm`,valor:c})}}if(r.acabamentos.polimento&&r.acabamentos.polimento.ativo){let v=0;const N=r.acabamentos.polimento.lados;if(N.superior&&(v+=E),N.inferior&&(v+=E),N.esquerda&&(v+=q),N.direita&&(v+=q),v>0){const c=v/1e3*b.polimento;j+=c,O.push({tipo:"Polimento",peca:S,medida:`${v}mm`,valor:c})}}if(r.acabamentos.canal&&r.acabamentos.canal.ativo){let v=0;const N=r.acabamentos.canal.lados;if(N.superior&&(v+=E),N.inferior&&(v+=E),N.esquerda&&(v+=q),N.direita&&(v+=q),v>0){const c=v/1e3*b.canal;j+=c,O.push({tipo:"Canal",peca:S,medida:`${v}mm`,valor:c})}}}if(r.cuba&&r.cuba>0){const E=r.cuba*b.pia;m+=E,M.push({tipo:"Cuba",peca:S,quantidade:r.cuba,valorUnit:b.pia,valor:E})}if(r.cubaEsculpida&&r.cubaEsculpida>0){const E=r.cubaEsculpida*b.cubaEsculpida;m+=E,M.push({tipo:"Cuba Esculpida",peca:S,quantidade:r.cubaEsculpida,valorUnit:b.cubaEsculpida,valor:E})}if(r.cooktop&&r.cooktop>0){const E=r.cooktop*b.cooktop;m+=E,M.push({tipo:"Cooktop",peca:S,quantidade:r.cooktop,valorUnit:b.cooktop,valor:E})}if(r.recorte&&r.recorte>0){const E=r.recorte*b.recorte;m+=E,M.push({tipo:"Recorte",peca:S,quantidade:r.recorte,valorUnit:b.recorte,valor:E})}if(r.pes&&r.pes>0){const E=r.pes*b.pes;m+=E,M.push({tipo:"P√©s",peca:S,quantidade:r.pes,valorUnit:b.pes,valor:E})}})});const a=f-u,y=u+j+m,g=f+j+m,n=g-y;return{custoChapas:u,vendaChapas:f,margemChapas:a,acabamentos:j,recortes:m,custoTotal:y,vendaTotal:g,margemTotal:n,chapasPorMaterial:d,detalhesChapas:l,detalhesAcabamentos:O,detalhesRecortes:M,subtotal:f,total:g}},It=()=>{const[s,h]=z.useState(He),[b,u]=z.useState(!1),[f,d]=z.useState(!1);return z.useEffect(()=>{const O=localStorage.getItem(ee.PRECOS);if(O)try{h(JSON.parse(O))}catch(M){console.error("Erro ao carregar pre√ßos:",M)}},[]),{precos:s,precosSalvos:b,mostrarPainelPrecos:f,atualizarPreco:(O,M)=>{const a=parseFloat(M)||0;h(y=>({...y,[O]:a})),u(!1)},salvarPrecos:()=>{localStorage.setItem(ee.PRECOS,JSON.stringify(s)),u(!0),setTimeout(()=>{u(!1)},3e3)},togglePainelPrecos:()=>{d(O=>!O)},setMostrarPainelPrecos:d}},Rt=()=>{const[s,h]=z.useState([{id:1,nome:"M√°rmore Branco Carrara",comprimento:3e3,altura:2e3,custo:250,venda:333.33,precoPorMetro:!0}]),[b,u]=z.useState(null),[f,d]=z.useState({nome:"",comprimento:"",altura:"",custo:"",venda:""});z.useEffect(()=>{const n=localStorage.getItem(ee.MATERIAIS);if(n)try{const I=JSON.parse(n);Array.isArray(I)&&I.length>0&&h(I)}catch(I){console.error("Erro ao carregar materiais:",I)}},[]),z.useEffect(()=>{s.length>0&&(localStorage.setItem(ee.MATERIAIS,JSON.stringify(s)),console.log("üíæ Materiais salvos automaticamente"))},[s]);const l=n=>{const I=s.length>0?Math.max(...s.map(r=>r.id))+1:1,w={...n,id:I,comprimento:parseFloat(n.comprimento)||0,altura:parseFloat(n.altura)||0,custo:parseFloat(n.custo)||0,venda:parseFloat(n.venda)||parseFloat(n.custo)||0,precoPorMetro:!0};h(r=>[...r,w]),a()},j=n=>{h(I=>I.filter(w=>w.id!==n))},m=(n,I)=>{const w=s.map(r=>r.id===n?{...r,...I}:r);h(w)},O=n=>{u(n),d({nome:n.nome,comprimento:n.comprimento.toString(),altura:n.altura.toString(),custo:n.custo.toString(),venda:n.venda.toString()})},M=()=>{u(null),a()},a=()=>{d({nome:"",comprimento:"",altura:"",custo:"",venda:""})};return{materiais:s,materialEditando:b,novoMaterial:f,setMateriais:h,setMaterialEditando:u,setNovoMaterial:d,adicionarMaterial:l,excluirMaterial:j,atualizarMaterialSimples:m,iniciarEdicao:O,cancelarEdicao:M,resetNovoMaterial:a,atualizarCampoMaterial:(n,I)=>{d(w=>({...w,[n]:I}))},buscarMaterialPorId:n=>s.find(I=>I.id===n)}},Tt=()=>{const[s,h]=z.useState([]),[b,u]=z.useState(null),[f,d]=z.useState(!1),[l,j]=z.useState("");z.useEffect(()=>{const r=localStorage.getItem(ee.ORCAMENTOS);if(r)try{const D=JSON.parse(r);Array.isArray(D)&&h(D)}catch(D){console.error("Erro ao carregar or√ßamentos:",D)}},[]),z.useEffect(()=>{localStorage.setItem(ee.ORCAMENTOS,JSON.stringify(s)),console.log("üíæ Or√ßamentos salvos automaticamente")},[s]);const m=()=>{d(!0),j("")},O=()=>{d(!1),j("")},M=r=>{const D=r||l;if(!D.trim())return alert("Por favor, insira um nome para o or√ßamento."),null;const E={id:s.length>0?Math.max(...s.map(q=>q.id))+1:1,nome:D,dataCriacao:new Date().toISOString(),ambientes:[],chapas:[]};return h(q=>[...q,E]),u(E),O(),E},a=r=>{if(!b)return;const S={id:b.ambientes.length>0?Math.max(...b.ambientes.map(q=>q.id))+1:1,nome:r,pecas:[]},E={...b,ambientes:[...b.ambientes,S]};u(E),h(q=>q.map(v=>v.id===b.id?E:v))},y=r=>{if(!b)return;const D={...b,ambientes:b.ambientes.filter(S=>S.id!==r)};u(D),h(S=>S.map(E=>E.id===b.id?D:E))},g=r=>{const D=s.find(S=>S.id===r);D&&u(D)},n=r=>{h(D=>D.filter(S=>S.id!==r)),(b==null?void 0:b.id)===r&&u(null)},I=()=>{b&&h(r=>r.find(S=>S.id===b.id)?r.map(S=>S.id===b.id?b:S):[...r,b])};return{orcamentos:s,orcamentoAtual:b,mostrarModalNovoOrcamento:f,nomeNovoOrcamento:l,setOrcamentos:h,setOrcamentoAtual:u,setNomeNovoOrcamento:j,abrirModalNovoOrcamento:m,fecharModalNovoOrcamento:O,criarOrcamento:M,adicionarAmbiente:a,removerAmbiente:y,carregarOrcamento:g,excluirOrcamento:n,salvarOrcamentoAtual:I,atualizarNomeOrcamento:r=>{if(!b)return;const D={...b,nome:r};u(D),I()}}},_e=()=>e.jsx("span",{children:"‚ûï"}),Ie=()=>e.jsx("span",{children:"üóëÔ∏è"}),dt=()=>e.jsx("span",{children:"‚úèÔ∏è"}),We=()=>e.jsx("span",{children:"üíæ"}),Ue=()=>e.jsx("span",{children:"‚ùå"}),Ft=()=>e.jsx("span",{children:"‚ÜîÔ∏è"}),Je=()=>e.jsx("span",{children:"‚äû"}),Ge=()=>e.jsx("span",{children:"üìÑ"}),zt=()=>e.jsx("span",{children:"üè†"}),qt=()=>e.jsx("span",{children:"üì¶"}),Dt=()=>e.jsx("span",{children:"üñ®Ô∏è"}),Lt=()=>{var $e;const{precos:s,precosSalvos:h,mostrarPainelPrecos:b,atualizarPreco:u,salvarPrecos:f,setMostrarPainelPrecos:d}=It(),{materiais:l,materialEditando:j,novoMaterial:m,setMateriais:O,setMaterialEditando:M,setNovoMaterial:a}=Rt(),{orcamentos:y,orcamentoAtual:g,mostrarModalNovoOrcamento:n,nomeNovoOrcamento:I,setOrcamentos:w,setOrcamentoAtual:r,setNomeNovoOrcamento:D,abrirModalNovoOrcamento:S,fecharModalNovoOrcamento:E,criarOrcamento:q,adicionarAmbiente:v,salvarOrcamentoAtual:N}=Tt(),[c,$]=z.useState("lista"),[P,K]=z.useState(null),[p,C]=z.useState(!1),[x,k]=z.useState(null),[R,W]=z.useState(null),[ge,de]=z.useState(null);z.useEffect(()=>{const t=localStorage.getItem("pietra_materiais"),o=localStorage.getItem("pietra_orcamentos");if(t)try{const i=JSON.parse(t);Array.isArray(i)&&i.length>0&&O(i)}catch(i){console.error("Erro ao carregar materiais:",i)}if(o)try{const i=JSON.parse(o);Array.isArray(i)&&w(i)}catch(i){console.error("Erro ao carregar or√ßamentos:",i)}},[]),z.useEffect(()=>{l.length>0&&(localStorage.setItem("pietra_materiais",JSON.stringify(l)),console.log("üíæ Materiais salvos automaticamente"))},[l]),z.useEffect(()=>{localStorage.setItem("pietra_orcamentos",JSON.stringify(y)),console.log("üíæ Or√ßamentos salvos automaticamente")},[y]);const me=async()=>{if(!window.jspdf)return new Promise(t=>{const o=document.createElement("script");o.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js",o.onload=()=>{le(),t()},o.onerror=()=>{alert("‚ùå Erro ao carregar biblioteca PDF."),t()},document.head.appendChild(o)});le()},le=()=>{const{jsPDF:t}=window.jspdf;if(!g||!g.chapas||g.chapas.length===0){alert("‚ö†Ô∏è Nenhuma chapa no plano de corte.");return}const o=new t({orientation:"landscape",unit:"mm",format:"a4"}),i=297,F=210,T=15,Y=22;g.chapas.forEach((_,U)=>{var at,st,ot;U>0&&o.addPage(),o.setFillColor(30,41,59),o.rect(0,0,i,Y,"F"),o.setTextColor(255,255,255),o.setFontSize(14),o.setFont("helvetica","bold"),o.text("PLANO DE CORTE",T,10),o.setFontSize(9),o.setFont("helvetica","normal"),o.text("Or√ßamento: "+g.nome,T,17),o.setFont("helvetica","bold"),o.setFontSize(11),o.text("Chapa "+(U+1)+" / "+g.chapas.length,i-T-45,10),o.setFontSize(8),o.setFont("helvetica","normal"),o.text(((at=_.material)==null?void 0:at.nome)||"Material",i-T-45,17);const L=58,J=Y+8,Z=T+L+15,ne=i-T,V=F-T-8,ue=ne-Z,Re=V-J,Ee=((st=_.material)==null?void 0:st.comprimento)||3e3,Ae=((ot=_.material)==null?void 0:ot.altura)||2e3,Xe=ue/Ee,Ye=Re/Ae,be=Math.min(Xe,Ye)*.92,ie=Ee*be,fe=Ae*be,te=Z+(ue-ie)/2,ae=J+(Re-fe)/2;o.setTextColor(80,80,80),o.setFontSize(8),o.setFont("helvetica","normal");const je=ae-5;o.setDrawColor(100,100,100),o.setLineWidth(.3),o.line(te,je,te+ie,je),o.line(te,je-2,te,je+2),o.line(te+ie,je-2,te+ie,je+2),o.setTextColor(30,41,59),o.setFont("helvetica","bold"),o.text(Ee+" mm",te+ie/2,je-2,{align:"center"});const Ne=te-5;o.setDrawColor(100,100,100),o.setFont("helvetica","normal"),o.line(Ne,ae,Ne,ae+fe),o.line(Ne-2,ae,Ne+2,ae),o.line(Ne-2,ae+fe,Ne+2,ae+fe),o.setFont("helvetica","bold"),o.text(Ae+" mm",Ne-3,ae+fe/2,{angle:90,align:"center"}),o.setFillColor(249,250,251),o.setDrawColor(55,65,81),o.setLineWidth(1.2),o.roundedRect(te,ae,ie,fe,1,1,"FD"),o.setDrawColor(220,220,220),o.setLineWidth(.2);const Te=500*be;for(let X=Te;X<ie;X+=Te)o.line(te+X,ae,te+X,ae+fe);for(let X=Te;X<fe;X+=Te)o.line(te,ae+X,te+ie,ae+X);const Ze=["#3b82f6","#10b981","#8b5cf6","#f59e0b","#ef4444","#06b6d4","#ec4899","#14b8a6"],Be=[],Fe=.5,et=Fe/2;_.pecas.forEach((X,Oe)=>{const Se=te+X.posX*be,Pe=ae+X.posY*be,ce=(X.rotacao===90?X.altura:X.comprimento)*be,se=(X.rotacao===90?X.comprimento:X.altura)*be,ke=Ze[Oe%Ze.length],ze=parseInt(ke.slice(1,3),16),qe=parseInt(ke.slice(3,5),16),De=parseInt(ke.slice(5,7),16);if(o.setFillColor(ze+(255-ze)*.75,qe+(255-qe)*.75,De+(255-De)*.75),o.rect(Se,Pe,ce,se,"F"),o.setDrawColor(ze,qe,De),o.setLineWidth(Fe),o.rect(Se+et,Pe+et,ce-Fe,se-Fe,"D"),ce>3&&se>3&&(o.setTextColor(ze,qe,De),o.setFontSize(Math.min(12,ce*.45,se*.35)),o.setFont("helvetica","bold"),o.text(String(Oe+1),Se+ce/2,Pe+se/2+.5,{align:"center"}),ce>8&&se>7)){const pt=Math.min(5.5,ce*.2,se*.15);o.setFontSize(pt),o.setFont("helvetica","normal"),o.setTextColor(40,40,40);const ht=X.rotacao===90?X.altura+"x"+X.comprimento:X.comprimento+"x"+X.altura;o.text(ht,Se+ce/2,Pe+se/2+Math.min(3.5,se*.18),{align:"center"})}const xt=X.nome||"Pe√ßa "+(Oe+1),ut=X.rotacao===90?X.altura:X.comprimento,bt=X.rotacao===90?X.comprimento:X.altura;Be.push({numero:Oe+1,nome:xt,cor:ke,dim:ut+"x"+bt,rotado:X.rotacao===90})});const ye=T;let re=J+2;const tt=10;o.setFillColor(30,41,59),o.roundedRect(ye,re-4,L,10,1,1,"F"),o.setTextColor(255,255,255),o.setFontSize(8),o.setFont("helvetica","bold"),o.text("LEGENDA",ye+L/2,re+2,{align:"center"}),re+=12;const mt=Math.min(Be.length*tt+6,V-re);o.setFillColor(248,250,252),o.setDrawColor(200,210,220),o.setLineWidth(.3),o.roundedRect(ye,re-4,L,mt,1,1,"FD"),Be.forEach((X,Oe)=>{if(re+6>V)return;const Se=parseInt(X.cor.slice(1,3),16),Pe=parseInt(X.cor.slice(3,5),16),ce=parseInt(X.cor.slice(5,7),16);o.setFillColor(Se,Pe,ce),o.rect(ye+2,re-2.5,4,4,"F"),o.setTextColor(30,41,59),o.setFontSize(7),o.setFont("helvetica","bold"),o.text(X.numero+".",ye+8,re+.5),o.setFont("helvetica","normal"),o.setFontSize(6.5);let se=X.nome;se.length>18&&(se=se.substring(0,17)+"‚Ä¶"),o.text(se,ye+13,re+.5),o.setTextColor(100,110,120),o.setFontSize(5.5);const ke=X.rotado?" ‚Üª":"";o.text(X.dim+ke,ye+13,re+4.5),re+=tt}),o.setTextColor(150,150,150),o.setFontSize(6),o.setFont("helvetica","normal"),o.text("Gerado pelo Sistema Pietra  |  "+new Date().toLocaleDateString("pt-BR"),i/2,F-4,{align:"center"})});const B=g.nome.replace(/[^a-z0-9]/gi,"_");o.save("PlanoCorte_"+B+"_"+new Date().toISOString().split("T")[0]+".pdf"),alert(`‚úÖ PDF do Plano de Corte gerado!
`+g.chapas.length+" chapa(s)")},A=()=>{q(I)&&$("orcamento")},H=(t,o)=>{const i=l.find(V=>V.id===o.materialId);if(!i){alert("‚ùå Material n√£o encontrado!");return}const F=parseFloat(o.comprimento),T=parseFloat(o.altura),Y=i.comprimento,B=i.altura,_=F<=Y&&T<=B,U=T<=Y&&F<=B;if(!_&&!U){alert(`‚ùå Pe√ßa muito grande!

Pe√ßa: ${F} x ${T} mm
Chapa: ${Y} x ${B} mm

A pe√ßa n√£o cabe na chapa nem rotacionada.`);return}const L=!_&&U?90:0;L===90&&console.log("üîÑ Pe√ßa ser√° rotacionada automaticamente para caber na chapa");const J=[];for(let V=0;V<(o.quantidade||1);V++)J.push({...o,id:Date.now()+V+Math.random(),quantidade:1,ambienteId:t,chapaId:null,posX:0,posY:0,rotacao:L});const Z=g.ambientes.map(V=>V.id===t?{...V,pecas:[...V.pecas,...J]}:V),ne={...g,ambientes:Z};r(ne),w(V=>V.map(ue=>ue.id===g.id?ne:ue)),setTimeout(()=>{pe(ne)},0)},Q=(t,o)=>{console.log("üóëÔ∏è excluirPeca chamada com:",{ambienteId:t,pecaId:o});const i=g.ambientes.map(T=>T.id===t?(console.log("‚úÇÔ∏è Removendo pe√ßa do ambiente:",T.id),{...T,pecas:T.pecas.filter(Y=>Y.id!==o)}):T);console.log("üìã Ambientes atualizados:",i);const F={...g,ambientes:i};r(F),w(T=>T.map(Y=>Y.id===g.id?F:Y)),console.log("üíæ Or√ßamento atualizado, reorganizando chapas..."),setTimeout(()=>{pe(F),console.log("‚úÖ Chapas reorganizadas!")},0)},xe=()=>{if(!x||!P)return;const t=g.ambientes.map(i=>({...i,pecas:i.pecas.map(F=>F.id===P.id?x:F)})),o={...g,ambientes:t};r(o),w(i=>i.map(F=>F.id===g.id?o:F)),(x.comprimento!==P.comprimento||x.altura!==P.altura||x.materialId!==P.materialId)&&setTimeout(()=>{pe(o)},0),K(null),C(!1),k(null)},Ce=async()=>new Promise(t=>{if(window.jspdf){ve(),t();return}const o=document.createElement("script");o.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js",o.onload=()=>{ve(),t()},o.onerror=()=>{alert("‚ùå Erro ao carregar biblioteca PDF. Por favor, tente novamente."),t()},document.head.appendChild(o)}),ve=()=>{const{jsPDF:t}=window.jspdf,o=g.ambientes.flatMap(Y=>Y.pecas.map(B=>({...B,ambienteNome:Y.nome}))),i=new t({orientation:"landscape",unit:"mm",format:[100,60]});let F=!0;o.forEach((Y,B)=>{F||i.addPage([100,60],"landscape"),F=!1;const _=l.find(ue=>ue.id===Y.materialId),U=Math.round(Y.comprimento),L=Math.round(Y.altura);i.setTextColor(0,0,0),i.setFontSize(14),i.setFont("helvetica","bold"),i.text("PIETRA M√ìVEIS E REVESTIMENTOS",50,8,{align:"center"}),i.setDrawColor(0,0,0),i.setLineWidth(.3),i.line(5,10,95,10),i.setTextColor(0,0,0),i.setFontSize(8),i.setFont("helvetica","normal"),i.text("pietramoveiserevestimentos@gmail.com",50,14,{align:"center"}),i.setFontSize(9),i.text("(19) 99978-0110",50,18,{align:"center"}),i.line(5,20,95,20),i.setFontSize(10),i.setFont("helvetica","bold"),i.setTextColor(0,0,0),i.text("CLIENTE:",5,26),i.setTextColor(0,0,0),i.setFont("helvetica","normal");const J=g.nome||"Sem nome";i.text(J.toUpperCase(),25,26),i.setTextColor(0,0,0),i.setFont("helvetica","bold"),i.text("AMBIENTE:",5,32),i.setTextColor(0,0,0),i.setFont("helvetica","normal");const Z=Y.ambienteNome||"Sem ambiente";i.text(Z.toUpperCase(),25,32),i.setTextColor(0,0,0),i.setFont("helvetica","bold"),i.text("PE√áA:",5,38),i.setTextColor(0,0,0),i.setFont("helvetica","normal");const ne=Y.nome||"Sem nome";i.text(ne.toUpperCase(),25,38),i.setTextColor(0,0,0),i.setFont("helvetica","bold"),i.text("MEDIDA:",5,44),i.setTextColor(0,0,0),i.setFont("helvetica","normal"),i.text(`${U} X ${L} MM`,25,44),i.setTextColor(0,0,0),i.setFont("helvetica","bold"),i.text("MATERIAL:",5,50),i.setTextColor(0,0,0),i.setFont("helvetica","normal");const V=(_==null?void 0:_.nome)||"N/D";i.text(V.toUpperCase(),25,50),i.setDrawColor(0,0,0),i.setLineWidth(.3),i.line(5,55,95,55)});const T=`Etiquetas_${g.nome.replace(/[^a-z0-9]/gi,"_")}_${new Date().toISOString().split("T")[0]}.pdf`;i.save(T),alert(`‚úÖ PDF gerado com sucesso!
${o.length} etiqueta(s) - 1 por p√°gina
Arquivo: ${T}`)},pe=t=>{const o=At(t,l);r(o),w(i=>i.map(F=>F.id===t.id?o:F))},we=(t,o)=>{const i=g.ambientes.map(B=>({...B,pecas:B.pecas.map(_=>{if(_.id===t){const U=_.rotacao===0?90:0;return{..._,rotacao:U}}return _})})),F=i.flatMap(B=>B.pecas),T=g.chapas.map(B=>({...B,pecas:F.filter(_=>_.chapaId===B.id)})),Y={...g,ambientes:i,chapas:T};r(Y),w(B=>B.map(_=>_.id===g.id?Y:_))},he=(t,o,i,F)=>{const T=g.ambientes.map(U=>({...U,pecas:U.pecas.map(L=>L.id===t?{...L,chapaId:o,posX:i,posY:F}:L)})),Y=T.flatMap(U=>U.pecas),B=g.chapas.map(U=>({...U,pecas:Y.filter(L=>L.chapaId===U.id)})),_={...g,ambientes:T,chapas:B};r(_),w(U=>U.map(L=>L.id===g.id?_:L))},oe=(t,o)=>{const i=t.rotacao===90?t.altura:t.comprimento,F=t.rotacao===90?t.comprimento:t.altura,T=4,Y=o.material.comprimento,B=o.material.altura;if(i+T*2>Y||F+T*2>B)return null;const _=10;for(let U=T;U+F+T<=B;U+=_)for(let L=T;L+i+T<=Y;L+=_)if(!o.pecas.some(Z=>{if(Z.id===t.id)return!1;const ne=Z.rotacao===90?Z.altura:Z.comprimento,V=Z.rotacao===90?Z.comprimento:Z.altura,ue=L+i/2,Re=U+F/2,Ee=Z.posX+ne/2,Ae=Z.posY+V/2,Xe=Math.abs(ue-Ee),Ye=Math.abs(Re-Ae),be=(i+ne)/2+T,ie=(F+V)/2+T;return Xe<be&&Ye<ie}))return{x:L,y:U};return null},Me=(t,o)=>{let i=null;if(g.ambientes.forEach(L=>{const J=L.pecas.find(Z=>Z.id===t);J&&(i=J)}),!i){alert("‚ùå Erro: Pe√ßa n√£o encontrada.");return}const F=g.chapas.find(L=>L.id===o);if(!F){alert("‚ùå Erro: Chapa de destino n√£o encontrada.");return}const T=oe(i,F);if(!T){const L=i.rotacao===90?i.altura:i.comprimento,J=i.rotacao===90?i.comprimento:i.altura;alert(`‚ö†Ô∏è N√£o foi poss√≠vel mover a pe√ßa!

‚ùå N√£o h√° espa√ßo dispon√≠vel na chapa de destino.

üìè Dimens√µes da pe√ßa: `+L+" x "+J+` mm
üìê Dimens√µes da chapa: `+F.material.comprimento+" x "+F.material.altura+` mm

üí° Dica: Tente mover outras pe√ßas ou use outra chapa.`);return}const Y=g.ambientes.map(L=>({...L,pecas:L.pecas.map(J=>J.id===t?{...J,chapaId:o,posX:T.x,posY:T.y}:J)})),B=Y.flatMap(L=>L.pecas),_=g.chapas.map(L=>({...L,pecas:B.filter(J=>J.chapaId===L.id)})),U={...g,ambientes:Y,chapas:_};r(U),w(L=>L.map(J=>J.id===g.id?U:J)),alert(`‚úÖ Pe√ßa movida com sucesso!

üìç Posi√ß√£o: X=`+Math.round(T.x)+"mm, Y="+Math.round(T.y)+"mm")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-slate-100",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsx("header",{className:"bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl shadow-xl p-8 mb-8 border border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold text-white mb-2 flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center",children:e.jsx(Je,{size:28,className:"text-white"})}),"Sistema de Or√ßamento"]}),e.jsx("p",{className:"text-slate-300 text-lg",children:"M√°rmore & Granito - Gest√£o Profissional"})]}),c!=="lista"&&e.jsxs("button",{onClick:()=>$("lista"),className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-6 py-3 rounded-xl transition-all duration-200 border border-white/20",children:[e.jsx(zt,{size:20}),"In√≠cio"]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(_e,{size:24,className:"text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Novo Or√ßamento"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Nome do Or√ßamento"}),e.jsx("input",{type:"text",value:I,onChange:t=>D(t.target.value),onKeyPress:t=>{t.key==="Enter"&&A()},className:"w-full border-2 border-slate-200 rounded-xl px-4 py-3 focus:border-blue-500 focus:outline-none transition-colors",placeholder:"Ex: Cliente Jo√£o Silva - Cozinha",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>{E(),D("")},className:"px-6 py-3 border-2 border-slate-200 rounded-xl hover:bg-slate-50 transition-all duration-200 font-medium text-slate-700",children:"Cancelar"}),e.jsx("button",{onClick:A,className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl hover:shadow-lg transition-all duration-200 font-semibold",children:"Criar Or√ßamento"})]})]})}),P&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",onClick:()=>{K(null),C(!1),k(null)},children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl border border-slate-200 max-h-[85vh] overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"bg-gradient-to-r from-slate-700 to-slate-800 p-4 flex items-center justify-between flex-shrink-0",children:[e.jsxs("h3",{className:"text-xl font-bold text-white",children:[p?"‚úèÔ∏è Editando":"üëÅÔ∏è Visualizando",": ",P.nome||"Pe√ßa"]}),e.jsx("button",{onClick:()=>{K(null),C(!1),k(null)},className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-xl font-bold transition-all",children:"‚úñ FECHAR"})]}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto flex-1",children:[p?e.jsx("div",{className:"bg-yellow-100 border-2 border-yellow-500 rounded-xl p-3 text-center",children:e.jsx("p",{className:"text-yellow-900 font-bold",children:"‚úèÔ∏è MODO EDI√á√ÉO - Altere os campos abaixo"})}):e.jsx("button",{onClick:()=>{const t=JSON.parse(JSON.stringify(P));t.acabamentos||(t.acabamentos={polimento:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}},esquadria:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}},boleado:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}},canal:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}}}),t.cuba||(t.cuba=0),t.cubaEsculpida||(t.cubaEsculpida=0),t.cooktop||(t.cooktop=0),t.recorte||(t.recorte=0),t.pes||(t.pes=0),k(t),C(!0)},className:"w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white p-4 rounded-xl font-bold text-lg shadow-lg transition-all transform hover:scale-105",children:"‚úèÔ∏è CLIQUE AQUI PARA EDITAR ESTA PE√áA"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2 text-sm",children:"üìè Dimens√µes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-600 text-xs mb-1",children:"Nome:"}),p?e.jsx("input",{type:"text",value:(x==null?void 0:x.nome)||"",onChange:t=>k({...x,nome:t.target.value}),className:"w-full px-2 py-1 border-2 border-blue-400 rounded text-sm"}):e.jsx("span",{className:"font-bold text-slate-800 text-sm",children:P.nome||"Sem nome"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-600 text-xs mb-1",children:"Comprimento (mm):"}),p?e.jsx("input",{type:"number",value:(x==null?void 0:x.comprimento)||0,onChange:t=>k({...x,comprimento:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border-2 border-blue-400 rounded text-sm"}):e.jsxs("span",{className:"font-bold text-slate-800 text-sm",children:[P.comprimento," mm"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-600 text-xs mb-1",children:"Altura (mm):"}),p?e.jsx("input",{type:"number",value:(x==null?void 0:x.altura)||0,onChange:t=>k({...x,altura:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border-2 border-blue-400 rounded text-sm"}):e.jsxs("span",{className:"font-bold text-slate-800 text-sm",children:[P.altura," mm"]})]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 border border-green-200",children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-2 text-sm",children:"üì¶ Material"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-600 text-xs mb-1",children:"Material:"}),p?e.jsx("select",{value:(x==null?void 0:x.materialId)||"",onChange:t=>k({...x,materialId:parseInt(t.target.value)}),className:"w-full px-2 py-1 border-2 border-green-400 rounded text-sm",children:l.map(t=>e.jsx("option",{value:t.id,children:t.nome},t.id))}):e.jsx("span",{className:"font-bold text-slate-800 text-sm",children:(($e=l.find(t=>t.id===P.materialId))==null?void 0:$e.nome)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-600 text-xs mb-1",children:"Chapa:"}),e.jsxs("span",{className:"font-bold text-slate-800 text-sm",children:["#",P.chapaId?String(P.chapaId).slice(-4):"N/A"]})]})]})]})]}),(p||P.acabamentos&&Object.values(P.acabamentos).some(t=>t.ativo))&&e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 border border-purple-200",children:[e.jsx("h4",{className:"font-semibold text-purple-900 mb-2 text-sm",children:"‚ú® Acabamentos"}),p?e.jsx("div",{className:"space-y-2",children:["polimento","esquadria","boleado","canal"].map(t=>{var o,i,F,T;return e.jsxs("div",{className:"bg-white rounded p-2 border border-purple-300",children:[e.jsxs("label",{className:"flex items-center gap-2 mb-1",children:[e.jsx("input",{type:"checkbox",checked:((i=(o=x==null?void 0:x.acabamentos)==null?void 0:o[t])==null?void 0:i.ativo)||!1,onChange:Y=>{const B={...(x==null?void 0:x.acabamentos)||{}};B[t]||(B[t]={ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}}),B[t].ativo=Y.target.checked,k({...x,acabamentos:B})},className:"w-4 h-4"}),e.jsx("span",{className:"font-semibold text-sm capitalize",children:t})]}),((T=(F=x==null?void 0:x.acabamentos)==null?void 0:F[t])==null?void 0:T.ativo)&&e.jsx("div",{className:"flex flex-wrap gap-1 ml-6 mt-1",children:["superior","inferior","esquerda","direita"].map(Y=>{var B,_,U;return e.jsxs("label",{className:"flex items-center gap-1 text-xs",children:[e.jsx("input",{type:"checkbox",checked:((U=(_=(B=x==null?void 0:x.acabamentos)==null?void 0:B[t])==null?void 0:_.lados)==null?void 0:U[Y])||!1,onChange:L=>{const J={...x.acabamentos};J[t].lados[Y]=L.target.checked,k({...x,acabamentos:J})},className:"w-3 h-3"}),e.jsx("span",{children:Y})]},Y)})})]},t)})}):e.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:Object.keys(P.acabamentos).map(t=>{const o=P.acabamentos[t];if(!o.ativo)return null;const i=Object.keys(o.lados).filter(F=>o.lados[F]);return e.jsxs("div",{className:"bg-white rounded p-2 border border-purple-300",children:[e.jsx("div",{className:"font-semibold text-slate-800 capitalize text-sm mb-1",children:t}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.map(F=>e.jsx("span",{className:"text-xs bg-purple-100 text-purple-700 px-1 py-0.5 rounded",children:F},F))})]},t)})})]}),(p||P.cuba>0||P.cubaEsculpida>0||P.cooktop>0||P.recorte>0||P.pes>0)&&e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 border border-orange-200",children:[e.jsx("h4",{className:"font-semibold text-orange-900 mb-2 text-sm",children:"üîß Recortes"}),p?e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Pia/Cuba:"}),e.jsx("input",{type:"number",value:(x==null?void 0:x.cuba)||0,onChange:t=>k({...x,cuba:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border border-orange-300 rounded text-sm",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Cuba Esculpida:"}),e.jsx("input",{type:"number",value:(x==null?void 0:x.cubaEsculpida)||0,onChange:t=>k({...x,cubaEsculpida:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border border-orange-300 rounded text-sm",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Cooktop:"}),e.jsx("input",{type:"number",value:(x==null?void 0:x.cooktop)||0,onChange:t=>k({...x,cooktop:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border border-orange-300 rounded text-sm",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Recorte:"}),e.jsx("input",{type:"number",value:(x==null?void 0:x.recorte)||0,onChange:t=>k({...x,recorte:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border border-orange-300 rounded text-sm",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"P√©s:"}),e.jsx("input",{type:"number",value:(x==null?void 0:x.pes)||0,onChange:t=>k({...x,pes:parseInt(t.target.value)||0}),className:"w-full px-2 py-1 border border-orange-300 rounded text-sm",min:"0"})]})]}):e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[P.cuba>0&&e.jsxs("div",{className:"bg-white rounded p-2 text-center border border-orange-300",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Cuba"}),e.jsxs("div",{className:"font-bold text-slate-800",children:[P.cuba,"x"]})]}),P.cubaEsculpida>0&&e.jsxs("div",{className:"bg-white rounded p-2 text-center border border-orange-300",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Cuba Esculpida"}),e.jsxs("div",{className:"font-bold text-slate-800",children:[P.cubaEsculpida,"x"]})]}),P.cooktop>0&&e.jsxs("div",{className:"bg-white rounded p-2 text-center border border-orange-300",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Cooktop"}),e.jsxs("div",{className:"font-bold text-slate-800",children:[P.cooktop,"x"]})]}),P.recorte>0&&e.jsxs("div",{className:"bg-white rounded p-2 text-center border border-orange-300",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Recorte"}),e.jsxs("div",{className:"font-bold text-slate-800",children:[P.recorte,"x"]})]}),P.pes>0&&e.jsxs("div",{className:"bg-white rounded p-2 text-center border border-orange-300",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"P√©s"}),e.jsxs("div",{className:"font-bold text-slate-800",children:[P.pes,"x"]})]})]})]})]}),p&&e.jsxs("div",{className:"bg-white p-3 border-t border-slate-200 flex justify-end gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>{C(!1),k(null)},className:"px-4 py-2 border border-slate-300 text-slate-700 rounded-lg font-semibold hover:bg-slate-100",children:"Cancelar"}),e.jsxs("button",{onClick:xe,className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold flex items-center gap-2",children:[e.jsx(We,{size:18}),"üíæ Salvar"]})]})]})}),R&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[10000] p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 border-4 border-red-500",children:[e.jsx("div",{className:"bg-gradient-to-r from-red-600 to-red-700 p-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(Ie,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Excluir Pe√ßa"}),e.jsx("p",{className:"text-red-100 text-sm",children:"Esta a√ß√£o n√£o pode ser desfeita"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700 text-lg mb-2",children:"Deseja realmente excluir esta pe√ßa?"}),e.jsx("p",{className:"text-gray-900 font-bold text-xl bg-gray-100 p-3 rounded-lg",children:R.pecaNome||"Pe√ßa sem nome"}),e.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"A pe√ßa ser√° removida e as chapas ser√£o reorganizadas automaticamente."})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-b-2xl flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>{console.log("‚ùå Cancelou exclus√£o"),W(null)},className:"px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-100 transition-all",children:"Cancelar"}),e.jsxs("button",{onClick:()=>{console.log("‚úÖ Confirmou exclus√£o"),Q(R.ambienteId,R.pecaId),W(null)},className:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all flex items-center gap-2",children:[e.jsx(Ie,{size:20}),"Excluir Pe√ßa"]})]})]})}),c==="lista"&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200",children:[e.jsxs("button",{onClick:()=>d(!b),className:"w-full flex items-center justify-between p-6 hover:bg-slate-50 transition-colors rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xl font-bold",children:"R$"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Configura√ß√£o de Pre√ßos"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Acabamentos e recortes"})]})]}),e.jsx("div",{className:"text-slate-400",children:b?"‚ñ≤":"‚ñº"})]}),b&&e.jsxs("div",{className:"px-6 pb-6 pt-2 border-t border-slate-200",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-slate-700 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Acabamentos (por metro linear)"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Polimento"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:s.polimento,onChange:t=>u("polimento",t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:border-blue-500",step:"0.01",min:"0"}),e.jsx("span",{className:"text-slate-500 text-sm",children:"/m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Esquadria"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:s.esquadria,onChange:t=>u("esquadria",t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:border-blue-500",step:"0.01",min:"0"}),e.jsx("span",{className:"text-slate-500 text-sm",children:"/m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Boleado"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:s.boleado,onChange:t=>u("boleado",t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:border-blue-500",step:"0.01",min:"0"}),e.jsx("span",{className:"text-slate-500 text-sm",children:"/m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Canal"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:s.canal,onChange:t=>u("canal",t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:border-blue-500",step:"0.01",min:"0"}),e.jsx("span",{className:"text-slate-500 text-sm",children:"/m"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-slate-700 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"Recortes (por unidade)"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Pia/Cuba"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:s.pia,onChange:t=>u("pia",t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:border-blue-500",step:"0.01",min:"0"}),e.jsx("span",{className:"text-slate-500 text-sm",children:"/un"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Cuba Esculpida"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:s.cubaEsculpida,onChange:t=>u("cubaEsculpida",t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:border-blue-500",step:"0.01",min:"0"}),e.jsx("span",{className:"text-slate-500 text-sm",children:"/un"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Cooktop"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:s.cooktop,onChange:t=>u("cooktop",t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:border-blue-500",step:"0.01",min:"0"}),e.jsx("span",{className:"text-slate-500 text-sm",children:"/un"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Recorte Gen√©rico"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:s.recorte,onChange:t=>u("recorte",t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:border-blue-500",step:"0.01",min:"0"}),e.jsx("span",{className:"text-slate-500 text-sm",children:"/un"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"P√©s"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:s.pes,onChange:t=>u("pes",t.target.value),className:"flex-1 px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:border-blue-500",step:"0.01",min:"0"}),e.jsx("span",{className:"text-slate-500 text-sm",children:"/un"})]})]})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between gap-4",children:[e.jsxs("button",{onClick:f,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${h?"bg-green-500 text-white shadow-lg":"bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:shadow-lg"}`,children:[e.jsx(We,{size:20}),h?"‚úì Salvo com Sucesso!":"Salvar Configura√ß√µes"]}),!h&&e.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"‚ö†Ô∏è H√° altera√ß√µes n√£o salvas"})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["üí° ",e.jsx("strong",{children:"Dica:"}),' Estes valores ser√£o usados automaticamente em todos os or√ßamentos. Clique em "Salvar" para confirmar!']})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-slate-200 hover:shadow-xl transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center",children:e.jsx(qt,{size:20,className:"text-white"})}),e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Materiais"})]}),e.jsxs("button",{onClick:()=>$("novo-material"),className:"flex items-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2.5 rounded-xl hover:shadow-lg transition-all duration-200 font-medium",children:[e.jsx(_e,{size:18}),"Novo"]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:l.map(t=>e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100 border border-slate-200 rounded-xl p-4 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:t.nome}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Dimens√µes"}),e.jsxs("p",{className:"text-sm font-semibold text-slate-700",children:[t.comprimento," x ",t.altura," mm"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Custo"}),e.jsx("p",{className:"text-sm font-semibold text-orange-600",children:G(t.custo)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Venda"}),e.jsx("p",{className:"text-sm font-semibold text-green-600",children:G(t.venda||t.custo)})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>{M(t),a({nome:t.nome,comprimento:t.comprimento.toString(),altura:t.altura.toString(),custo:t.custo.toString(),venda:(t.venda||t.custo).toString()}),$("editar-material")},className:"text-blue-600 hover:bg-blue-50 p-2 rounded-lg transition-colors",title:"Editar material",children:e.jsx(dt,{size:18})}),e.jsx("button",{onClick:()=>{window.confirm("Deseja realmente excluir este material?")&&O(l.filter(o=>o.id!==t.id))},className:"text-red-600 hover:bg-red-50 p-2 rounded-lg transition-colors",title:"Excluir material",children:e.jsx(Ie,{size:18})})]})]})},t.id))})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-slate-200 hover:shadow-xl transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center",children:e.jsx(Ge,{size:20,className:"text-white"})}),e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Or√ßamentos"})]}),e.jsxs("button",{onClick:S,className:"flex items-center gap-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white px-4 py-2.5 rounded-xl hover:shadow-lg transition-all duration-200 font-medium",children:[e.jsx(_e,{size:18}),"Novo"]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:y.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(Ge,{size:32,className:"text-slate-400"})}),e.jsx("p",{className:"text-slate-500",children:"Nenhum or√ßamento criado ainda"})]}):y.map(t=>{const o=t.ambientes.reduce((F,T)=>F+T.pecas.length,0),i=ct(t,l,s);return e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100 border border-slate-200 rounded-xl p-4 hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>{r(t),$("orcamento")},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-slate-800 text-lg",children:t.nome||`Or√ßamento #${String(t.id).slice(-6)}`}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["üìÖ ",t.data]}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-slate-600",children:[e.jsxs("span",{children:["üè† ",t.ambientes.length," ambientes"]}),e.jsxs("span",{children:["üì¶ ",o," pe√ßas"]}),e.jsxs("span",{children:["üìÑ ",t.chapas.length," chapas"]})]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Custo"}),e.jsx("p",{className:"text-lg font-bold text-orange-600",children:G(i.custoTotal)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase",children:"Venda"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:G(i.vendaTotal)})]}),e.jsx("div",{className:"pt-1 border-t border-slate-300",children:e.jsxs("p",{className:"text-xs text-blue-600 font-semibold",children:["üí∞ Lucro: ",G(i.margemTotal)]})})]}),e.jsxs("button",{onClick:F=>{F.stopPropagation(),window.confirm("Deseja realmente excluir este or√ßamento?")&&w(y.filter(T=>T.id!==t.id))},className:"mt-3 text-red-600 hover:bg-red-50 px-3 py-1 rounded-lg text-xs flex items-center gap-1 transition-colors",children:[e.jsx(Ie,{size:14}),"Excluir"]})]})]})},t.id)})})]})]})]}),c==="novo-material"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Novo Material"}),e.jsx("button",{onClick:()=>$("lista"),className:"text-gray-600 hover:text-gray-800",children:e.jsx(Ue,{size:24})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 max-w-2xl",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Material"}),e.jsx("input",{type:"text",value:m.nome,onChange:t=>a({...m,nome:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Ex: M√°rmore Branco Carrara"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comprimento da Chapa (mm)"}),e.jsx("input",{type:"number",value:m.comprimento,onChange:t=>a({...m,comprimento:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"3000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Altura da Chapa (mm)"}),e.jsx("input",{type:"number",value:m.altura,onChange:t=>a({...m,altura:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"2000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custo por Chapa (R$)"}),e.jsx("input",{type:"number",value:m.custo,onChange:t=>a({...m,custo:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"1500.00",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pre√ßo de Venda (R$)"}),e.jsx("input",{type:"number",value:m.venda,onChange:t=>a({...m,venda:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"2000.00",step:"0.01"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>{m.nome&&m.comprimento&&m.altura&&m.custo&&m.venda&&(O([...l,{id:Date.now(),nome:m.nome,comprimento:parseFloat(m.comprimento),altura:parseFloat(m.altura),custo:parseFloat(m.custo),venda:parseFloat(m.venda)}]),a({nome:"",comprimento:"",altura:"",custo:"",venda:""}),$("lista"))},className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Salvar Material"})})]}),c==="editar-material"&&j&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Editar Material"}),e.jsx("button",{onClick:()=>{$("lista"),M(null),a({nome:"",comprimento:"",altura:"",custo:"",venda:""})},className:"text-gray-600 hover:text-gray-800",children:e.jsx(Ue,{size:24})})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-yellow-800 font-semibold mb-1",children:"‚ö†Ô∏è Aten√ß√£o: Altera√ß√µes neste material afetar√£o todos os or√ßamentos"}),e.jsxs("p",{className:"text-xs text-yellow-700",children:["‚Ä¢ Mudan√ßas de pre√ßo: atualizam o valor dos or√ßamentos automaticamente",e.jsx("br",{}),"‚Ä¢ Mudan√ßas de tamanho: reorganizam as pe√ßas e podem adicionar novas chapas se necess√°rio"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 max-w-2xl",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Material"}),e.jsx("input",{type:"text",value:m.nome,onChange:t=>a({...m,nome:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"Ex: M√°rmore Branco Carrara"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comprimento da Chapa (mm)"}),e.jsx("input",{type:"number",value:m.comprimento,onChange:t=>a({...m,comprimento:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"3000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Altura da Chapa (mm)"}),e.jsx("input",{type:"number",value:m.altura,onChange:t=>a({...m,altura:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"2000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custo por Chapa (R$)"}),e.jsx("input",{type:"number",value:m.custo,onChange:t=>a({...m,custo:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"1500.00",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pre√ßo de Venda (R$)"}),e.jsx("input",{type:"number",value:m.venda,onChange:t=>a({...m,venda:t.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2",placeholder:"2000.00",step:"0.01"})]})]}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx("button",{onClick:()=>{m.nome&&m.comprimento&&m.altura&&m.custo&&m.venda&&(atualizarMaterial(j.id,{nome:m.nome,comprimento:parseFloat(m.comprimento),altura:parseFloat(m.altura),custo:parseFloat(m.custo),venda:parseFloat(m.venda)}),a({nome:"",comprimento:"",altura:"",custo:"",venda:""}),M(null),$("lista"),alert(`Material atualizado com sucesso!

Todos os or√ßamentos foram recalculados.
Pe√ßas foram reorganizadas nas chapas conforme o novo tamanho.`))},className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Salvar Altera√ß√µes"}),e.jsx("button",{onClick:()=>{$("lista"),M(null),a({nome:"",comprimento:"",altura:"",custo:"",venda:""})},className:"border border-gray-300 px-6 py-2 rounded-lg hover:bg-gray-50",children:"Cancelar"})]})]}),c==="orcamento"&&g&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("input",{type:"text",value:g.nome,onChange:t=>r({...g,nome:t.target.value}),className:"text-2xl font-semibold text-gray-800 border-b-2 border-transparent hover:border-blue-300 focus:border-blue-500 focus:outline-none w-full",placeholder:"Nome do or√ßamento"})}),e.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Criado em: ",g.data]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>$("plano-corte"),className:"flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700",children:[e.jsx(Je,{size:20}),"Plano de Corte"]}),e.jsxs("button",{onClick:()=>Ce(),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[e.jsx(Dt,{size:20}),"Gerar Etiquetas"]}),e.jsxs("button",{onClick:()=>{N(),alert("‚úÖ Or√ßamento salvo com sucesso!"),$("lista"),r(null)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:[e.jsx(We,{size:20}),"Salvar Or√ßamento"]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"text",placeholder:"Nome do ambiente (ex: Cozinha)",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2",onKeyPress:t=>{t.key==="Enter"&&(v(t.target.value),t.target.value="")}}),e.jsx("button",{onClick:t=>{const o=t.target.previousSibling;v(o.value),o.value=""},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Adicionar Ambiente"})]})}),e.jsx("div",{className:"space-y-4",style:{opacity:P||R?0:1,pointerEvents:P||R?"none":"auto",transition:"opacity 0.3s"},children:g.ambientes.map(t=>e.jsx($t,{ambiente:t,materiais:l,precos:s,onAdicionarPeca:o=>H(t.id,o),onExcluirPeca:o=>Q(t.id,o),onVisualizarPeca:o=>K(o),onPedirConfirmacaoExclusao:(o,i)=>{W({pecaId:o,ambienteId:t.id,pecaNome:i})}},t.id))})]}),e.jsx(Xt,{orcamentoAtual:g,materiais:l,precos:s})]}),c==="plano-corte"&&g&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center",children:e.jsx(Je,{size:20,className:"text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Plano de Corte"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:me,className:"flex items-center gap-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white px-4 py-2.5 rounded-xl hover:shadow-lg transition-all duration-200 font-medium",children:[e.jsx(Ge,{size:20}),"Imprimir Plano"]}),e.jsxs("button",{onClick:()=>$("orcamento"),className:"flex items-center gap-2 text-slate-600 hover:text-slate-800 border-2 border-slate-200 px-4 py-2.5 rounded-xl hover:bg-slate-50 transition-all duration-200",children:[e.jsx(Ue,{size:20}),"Voltar"]})]})]}),e.jsx("div",{className:"space-y-6",children:g.chapas.map((t,o)=>e.jsx(Yt,{chapa:t,numero:o+1,onMoverPeca:Me,onMoverPecaNaChapa:he,onGirarPeca:we,pecaArrastando:ge,setPecaArrastando:de,todasChapas:g.chapas},t.id))})]})]})})},$t=({ambiente:s,materiais:h,precos:b,onAdicionarPeca:u,onExcluirPeca:f,onVisualizarPeca:d,onPedirConfirmacaoExclusao:l})=>{var g;const[j,m]=z.useState(!1),[O,M]=z.useState(!1),[a,y]=z.useState({nome:"",altura:"",comprimento:"",quantidade:1,materialId:((g=h[0])==null?void 0:g.id)||null,acabamentos:{esquadria:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}},boleado:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}},polimento:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}},canal:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}}},cuba:0,cubaEsculpida:0,cooktop:0,recorte:0,pes:0});return e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",style:{position:"relative",zIndex:1},children:[e.jsx("div",{className:"bg-gray-50 p-4 cursor-pointer hover:bg-gray-100",onClick:()=>m(!j),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s.nome}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.pecas.length," pe√ßas"]})]})}),j&&e.jsxs("div",{className:"p-4 space-y-4",children:[s.pecas.map(n=>{const I=h.find(r=>r.id===n.materialId),w=Et(n,I,b);return e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200 hover:border-blue-300 transition-all relative",style:{zIndex:1},children:[e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",style:{zIndex:2,position:"absolute"},children:[e.jsx("button",{type:"button",onClick:r=>{r.preventDefault(),r.stopPropagation(),console.log("üîµ Ver detalhes clicado"),d&&d(n)},onMouseEnter:()=>console.log("Mouse entrou no bot√£o AZUL"),className:"bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-lg shadow-lg transition-all",title:"Ver detalhes",style:{cursor:"pointer",pointerEvents:"auto"},children:e.jsx(dt,{size:18})}),e.jsx("button",{type:"button",onClick:r=>{r.preventDefault(),r.stopPropagation(),console.log("üî¥ CLICOU NO BOT√ÉO EXCLUIR"),console.log("Pe√ßa ID:",n.id),console.log("Ambiente ID:",s.id),l&&l(n.id,n.nome)},onMouseEnter:()=>console.log("Mouse entrou no bot√£o VERMELHO"),className:"bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg shadow-lg transition-all",title:"Excluir pe√ßa",style:{cursor:"pointer",pointerEvents:"auto"},children:e.jsx(Ie,{size:18})})]}),e.jsxs("div",{className:"flex gap-3 pr-24",children:[e.jsx("div",{className:"flex-shrink-0 cursor-pointer hover:scale-105 transition-transform",style:{width:"120px",height:"90px"},onClick:r=>{r.stopPropagation(),d&&d(n)},title:"Clique para ver detalhes",children:e.jsx(lt,{peca:n,mostrarSempre:!0,mini:!0})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:n.nome||"Sem nome"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs",children:"Dimens√µes"}),e.jsxs("p",{className:"font-medium text-xs",children:[n.comprimento," x ",n.altura," mm"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs",children:"Material"}),e.jsx("p",{className:"font-medium text-xs",children:I==null?void 0:I.nome})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs",children:"Chapa"}),e.jsxs("p",{className:"font-medium text-xs",children:["#",n.chapaId?String(n.chapaId).slice(-4):"N/A"]})]})]}),n.acabamentos&&Object.values(n.acabamentos).some(r=>r.ativo)&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:Object.keys(n.acabamentos).map(r=>{if(!n.acabamentos[r].ativo)return null;const S={esquadria:"bg-red-100 text-red-700",boleado:"bg-yellow-100 text-yellow-700",polimento:"bg-blue-100 text-blue-700",canal:"bg-orange-100 text-orange-700"};return e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${S[r]}`,children:r.charAt(0).toUpperCase()+r.slice(1)},r)})}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"√Årea:"}),e.jsxs("span",{className:"font-semibold text-gray-800 ml-1",children:[w.area.toFixed(2),"m¬≤"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Material:"}),e.jsx("span",{className:"font-semibold text-green-700 ml-1",children:G(w.custoMaterial)})]}),w.acabamentos>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Acabamentos:"}),e.jsx("span",{className:"font-semibold text-blue-700 ml-1",children:G(w.acabamentos)})]}),w.recortes>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Recortes:"}),e.jsx("span",{className:"font-semibold text-purple-700 ml-1",children:G(w.recortes)})]})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-300 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-gray-700",children:"Total da Pe√ßa:"}),e.jsx("span",{className:"text-sm font-bold text-green-600",children:G(w.total)})]}),(w.detalhesAcabamentos.length>0||w.detalhesRecortes.length>0)&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-xs text-blue-600 cursor-pointer hover:text-blue-800",children:"Ver detalhes dos custos"}),e.jsxs("div",{className:"mt-2 space-y-1 pl-2 border-l-2 border-blue-200",children:[w.detalhesAcabamentos.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700",children:"Acabamentos:"}),w.detalhesAcabamentos.map((r,D)=>e.jsxs("div",{className:"text-xs text-gray-600 flex justify-between",children:[e.jsxs("span",{children:["‚Ä¢ ",r.tipo.charAt(0).toUpperCase()+r.tipo.slice(1)," (",r.metros,"m)"]}),e.jsx("span",{className:"font-medium",children:G(r.valor)})]},D))]}),w.detalhesRecortes.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700",children:"Recortes:"}),w.detalhesRecortes.map((r,D)=>e.jsxs("div",{className:"text-xs text-gray-600 flex justify-between",children:[e.jsxs("span",{children:["‚Ä¢ ",r.tipo," (",r.quantidade,"x)"]}),e.jsx("span",{className:"font-medium",children:G(r.valor)})]},D))]})]})]})]})]})]})]},n.id)}),!O&&e.jsx("button",{onClick:()=>M(!0),className:"w-full border-2 border-dashed border-gray-300 rounded-lg p-4 text-gray-600 hover:border-blue-500 hover:text-blue-600",children:"+ Adicionar Pe√ßa"}),O&&e.jsxs("div",{className:"border-2 border-blue-200 rounded-lg p-4 bg-blue-50",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Nova Pe√ßa"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Nome da Pe√ßa *"}),e.jsx("input",{type:"text",value:a.nome,onChange:n=>y({...a,nome:n.target.value}),className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Ex: Bancada Pia, Mesa Jantar, etc"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Altura (mm)"}),e.jsx("input",{type:"number",value:a.altura,onChange:n=>y({...a,altura:n.target.value}),className:"w-full border rounded px-2 py-1 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Comprimento (mm)"}),e.jsx("input",{type:"number",value:a.comprimento,onChange:n=>y({...a,comprimento:n.target.value}),className:"w-full border rounded px-2 py-1 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Quantidade"}),e.jsx("input",{type:"number",value:a.quantidade,onChange:n=>y({...a,quantidade:parseInt(n.target.value)||1}),className:"w-full border rounded px-2 py-1 text-sm",min:"1"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Material"}),e.jsx("select",{value:a.materialId,onChange:n=>y({...a,materialId:parseInt(n.target.value)}),className:"w-full border rounded px-2 py-1 text-sm",children:h.map(n=>e.jsx("option",{value:n.id,children:n.nome},n.id))})]})]}),e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Acabamentos (opcional)"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.acabamentos.esquadria.ativo,onChange:n=>{y({...a,acabamentos:{...a.acabamentos,esquadria:{...a.acabamentos.esquadria,ativo:n.target.checked}}})},className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["Esquadria (R$ ",b.esquadria,"/m)"]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.acabamentos.boleado.ativo,onChange:n=>{y({...a,acabamentos:{...a.acabamentos,boleado:{...a.acabamentos.boleado,ativo:n.target.checked}}})},className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["Boleado (R$ ",b.boleado,"/m)"]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.acabamentos.polimento.ativo,onChange:n=>{y({...a,acabamentos:{...a.acabamentos,polimento:{...a.acabamentos.polimento,ativo:n.target.checked}}})},className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["Polimento (R$ ",b.polimento,"/m)"]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.acabamentos.canal.ativo,onChange:n=>{y({...a,acabamentos:{...a.acabamentos,canal:{...a.acabamentos.canal,ativo:n.target.checked}}})},className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["Canal (R$ ",b.canal,"/m)"]})]})]}),(a.acabamentos.esquadria.ativo||a.acabamentos.boleado.ativo||a.acabamentos.polimento.ativo||a.acabamentos.canal.ativo)&&e.jsxs("div",{className:"mb-3 bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsx("h6",{className:"font-semibold text-sm mb-3",children:"üìê Selecione os lados para cada acabamento:"}),e.jsx("div",{className:"space-y-4",children:[{tipo:"esquadria",label:"Esquadria",cor:"red",emoji:"üî¥"},{tipo:"boleado",label:"Boleado",cor:"yellow",emoji:"üü°"},{tipo:"polimento",label:"Polimento",cor:"blue",emoji:"üîµ"},{tipo:"canal",label:"Canal",cor:"orange",emoji:"üü†"}].filter(n=>a.acabamentos[n.tipo].ativo).map(n=>{const I={red:"bg-red-100 border-red-400 text-red-700",yellow:"bg-yellow-100 border-yellow-400 text-yellow-700",blue:"bg-blue-100 border-blue-400 text-blue-700",orange:"bg-orange-100 border-orange-400 text-orange-700"},w={red:"bg-red-500 text-white border-red-600",yellow:"bg-yellow-500 text-white border-yellow-600",blue:"bg-blue-500 text-white border-blue-600",orange:"bg-orange-500 text-white border-orange-600"},r={red:"bg-white text-red-400 border-red-200 hover:bg-red-50",yellow:"bg-white text-yellow-500 border-yellow-200 hover:bg-yellow-50",blue:"bg-white text-blue-400 border-blue-200 hover:bg-blue-50",orange:"bg-white text-orange-400 border-orange-200 hover:bg-orange-50"},D=q=>{const v={...a.acabamentos};v[n.tipo]={...v[n.tipo],lados:{...v[n.tipo].lados,[q]:!v[n.tipo].lados[q]}},y({...a,acabamentos:v})},S=a.acabamentos[n.tipo].lados,E=Object.keys(S).filter(q=>S[q]).length;return e.jsxs("div",{className:`rounded-lg p-3 border ${I[n.cor]}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-xs font-bold",children:[n.emoji," ",n.label]}),e.jsxs("span",{className:"text-xs opacity-70",children:[E," lado(s)"]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative",style:{width:"180px",height:"120px"},children:[e.jsx("button",{type:"button",onClick:()=>D("superior"),className:`absolute top-0 left-1/2 -translate-x-1/2 px-3 py-1 text-xs font-bold rounded-t-lg border-2 transition-all ${S.superior?w[n.cor]:r[n.cor]}`,style:{minWidth:"80px",zIndex:2},children:"Superior"}),e.jsx("button",{type:"button",onClick:()=>D("inferior"),className:`absolute bottom-0 left-1/2 -translate-x-1/2 px-3 py-1 text-xs font-bold rounded-b-lg border-2 transition-all ${S.inferior?w[n.cor]:r[n.cor]}`,style:{minWidth:"80px",zIndex:2},children:"Inferior"}),e.jsx("button",{type:"button",onClick:()=>D("esquerda"),className:`absolute left-0 top-1/2 -translate-y-1/2 px-1 py-2 text-xs font-bold rounded-l-lg border-2 transition-all ${S.esquerda?w[n.cor]:r[n.cor]}`,style:{writingMode:"vertical-lr",textOrientation:"mixed",zIndex:2},children:"Esq."}),e.jsx("button",{type:"button",onClick:()=>D("direita"),className:`absolute right-0 top-1/2 -translate-y-1/2 px-1 py-2 text-xs font-bold rounded-r-lg border-2 transition-all ${S.direita?w[n.cor]:r[n.cor]}`,style:{writingMode:"vertical-lr",textOrientation:"mixed",zIndex:2},children:"Dir."}),e.jsx("div",{className:"absolute bg-white border-2 border-gray-300 rounded flex items-center justify-center",style:{top:"22px",bottom:"22px",left:"26px",right:"26px"},children:e.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"PE√áA"})})]})}),e.jsx("div",{className:"flex justify-center mt-2 gap-2",children:e.jsx("button",{type:"button",onClick:()=>{const q={...a.acabamentos},v=S.superior&&S.inferior&&S.esquerda&&S.direita;q[n.tipo]={...q[n.tipo],lados:{superior:!v,inferior:!v,esquerda:!v,direita:!v}},y({...a,acabamentos:q})},className:`text-xs px-3 py-1 rounded-full border font-semibold transition-all ${S.superior&&S.inferior&&S.esquerda&&S.direita?w[n.cor]:"bg-gray-100 text-gray-600 border-gray-300 hover:bg-gray-200"}`,children:S.superior&&S.inferior&&S.esquerda&&S.direita?"‚úì Todos os lados":"Selecionar todos"})})]},n.tipo)})})]}),e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Recortes (opcional)"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Cuba"}),e.jsx("input",{type:"number",value:a.cuba,onChange:n=>y({...a,cuba:parseInt(n.target.value)||0}),className:"w-full border rounded px-2 py-1 text-sm",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Cuba Esculpida"}),e.jsx("input",{type:"number",value:a.cubaEsculpida,onChange:n=>y({...a,cubaEsculpida:parseInt(n.target.value)||0}),className:"w-full border rounded px-2 py-1 text-sm",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Cooktop"}),e.jsx("input",{type:"number",value:a.cooktop,onChange:n=>y({...a,cooktop:parseInt(n.target.value)||0}),className:"w-full border rounded px-2 py-1 text-sm",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"Recorte"}),e.jsx("input",{type:"number",value:a.recorte,onChange:n=>y({...a,recorte:parseInt(n.target.value)||0}),className:"w-full border rounded px-2 py-1 text-sm",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs mb-1",children:"P√©s"}),e.jsx("input",{type:"number",value:a.pes,onChange:n=>y({...a,pes:parseInt(n.target.value)||0}),className:"w-full border rounded px-2 py-1 text-sm",min:"0"})]})]}),a.comprimento&&a.altura&&e.jsx("div",{className:"mb-4",children:e.jsx(lt,{peca:a})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{var n;a.nome&&a.altura&&a.comprimento&&a.materialId?(u({...a,altura:parseFloat(a.altura),comprimento:parseFloat(a.comprimento)}),y({nome:"",altura:"",comprimento:"",quantidade:1,materialId:((n=h[0])==null?void 0:n.id)||null,acabamentos:{esquadria:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}},boleado:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}},polimento:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}},canal:{ativo:!1,lados:{superior:!1,inferior:!1,esquerda:!1,direita:!1}}},cuba:0,cubaEsculpida:0,cooktop:0,recorte:0,pes:0}),M(!1)):alert("Por favor, preencha o nome, altura e comprimento da pe√ßa!")},className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700",children:"Adicionar"}),e.jsx("button",{onClick:()=>M(!1),className:"border border-gray-300 px-4 py-2 rounded text-sm hover:bg-gray-50",children:"Cancelar"})]})]})]})]})},lt=({peca:s,mostrarSempre:h=!1,mini:b=!1})=>{const u=z.useRef(null);z.useEffect(()=>{f()},[s]);const f=()=>{const d=u.current;if(!d||!s.comprimento||!s.altura)return;const l=d.getContext("2d"),j=parseFloat(s.comprimento)||600,m=parseFloat(s.altura)||400,O=b?120:260,M=b?90:200,a=b?10:28,y=b?10:30,g=b?10:12,n=b?10:12,I=O-y-g,w=M-a-n,r=I/j,D=w/m,S=Math.min(r,D,b?.5:.55),E=j*S,q=m*S,v=y+(I-E)/2,N=a+(w-q)/2;d.width=O,d.height=M;const c=l.createLinearGradient(0,0,0,M);c.addColorStop(0,"#f8fafc"),c.addColorStop(1,"#e2e8f0"),l.fillStyle=c,l.fillRect(0,0,O,M),b||(l.shadowColor="rgba(0, 0, 0, 0.15)",l.shadowBlur=15,l.shadowOffsetX=3,l.shadowOffsetY=3);const $=l.createLinearGradient(v,N,v+E,N+q);$.addColorStop(0,"#ffffff"),$.addColorStop(1,"#f1f5f9"),l.fillStyle=$,l.fillRect(v,N,E,q),l.shadowColor="transparent",l.shadowBlur=0,l.shadowOffsetX=0,l.shadowOffsetY=0,l.strokeStyle="#94a3b8",l.lineWidth=b?1:2,l.strokeRect(v,N,E,q);const P={esquadria:"#ef4444",boleado:"#eab308",polimento:"#3b82f6",canal:"#f59e0b"},K=b?3:10;if(s.acabamentos&&Object.keys(s.acabamentos).forEach(p=>{const C=s.acabamentos[p];if(!C.ativo)return;const x=P[p],R=p==="canal"?K:0;l.strokeStyle=x,l.lineWidth=b?2:4,l.setLineDash(b?[5,2]:[10,5]),C.lados.superior&&(l.beginPath(),l.moveTo(v+R,N+R),l.lineTo(v+E-R,N+R),l.stroke()),C.lados.inferior&&(l.beginPath(),l.moveTo(v+R,N+q-R),l.lineTo(v+E-R,N+q-R),l.stroke()),C.lados.esquerda&&(l.beginPath(),l.moveTo(v+R,N+R),l.lineTo(v+R,N+q-R),l.stroke()),C.lados.direita&&(l.beginPath(),l.moveTo(v+E-R,N+R),l.lineTo(v+E-R,N+q-R),l.stroke()),l.setLineDash([])}),!b&&(l.fillStyle="#1e293b",l.font="bold 12px Arial",l.textAlign="center",l.fillStyle="#ffffff",l.fillRect(v+E/2-35,N-22,70,16),l.strokeStyle="#64748b",l.lineWidth=1,l.strokeRect(v+E/2-35,N-22,70,16),l.fillStyle="#1e293b",l.fillText(`${j} mm`,v+E/2,N-11),l.save(),l.translate(v-22,N+q/2),l.rotate(-Math.PI/2),l.fillStyle="#ffffff",l.fillRect(-35,-9,70,18),l.strokeStyle="#64748b",l.lineWidth=1,l.strokeRect(-35,-9,70,18),l.fillStyle="#1e293b",l.fillText(`${m} mm`,0,3),l.restore(),s.nome&&!b)){l.font="bold 12px Arial",l.textAlign="center";const p=s.nome.length>20?s.nome.substring(0,20)+"...":s.nome,C=l.measureText(p).width;l.fillStyle="rgba(59, 130, 246, 0.92)",l.fillRect(v+E/2-C/2-6,N+q/2-9,C+12,18),l.fillStyle="#ffffff",l.fillText(p,v+E/2,N+q/2+3)}};return e.jsxs("div",{className:`${b?"border border-gray-300 rounded":"border-2 border-gray-300 rounded-lg shadow-md"} bg-gradient-to-br from-slate-50 to-slate-100 overflow-hidden`,style:b?{}:{maxWidth:"260px"},children:[e.jsx("canvas",{ref:u,className:"w-full",style:b?{}:{maxWidth:"260px"}}),!h&&!b&&e.jsxs("div",{className:"p-3 border-t-2 border-gray-200 bg-white",children:[e.jsx("p",{className:"text-xs text-gray-600 text-center font-medium",children:"üëÅÔ∏è Pr√©-visualiza√ß√£o da pe√ßa"}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:"Use os bot√µes abaixo para selecionar os lados de cada acabamento"})]}),!b&&s.acabamentos&&Object.values(s.acabamentos).some(d=>d.ativo)&&e.jsxs("div",{className:"p-2 bg-white border-t border-gray-200",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Acabamentos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(s.acabamentos).map(d=>{if(!s.acabamentos[d].ativo)return null;const j={esquadria:"#ef4444",boleado:"#eab308",polimento:"#3b82f6",canal:"#f59e0b"};return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-0.5",style:{backgroundColor:j[d]}}),e.jsx("span",{className:"text-xs text-gray-700",children:d.charAt(0).toUpperCase()+d.slice(1)})]},d)})})]})]})},Xt=({orcamentoAtual:s,materiais:h,precos:b})=>{const u=ct(s,h,b);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-slate-200",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6 text-slate-800",children:"Resumo do Or√ßamento"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b-2 border-slate-300 mb-3",children:[e.jsx("span",{className:"font-bold text-lg text-slate-800",children:"Chapas de Material"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase",children:"Custo"}),e.jsx("span",{className:"font-bold text-lg text-orange-600",children:G(u.custoChapas)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase",children:"Venda"}),e.jsx("span",{className:"font-bold text-lg text-green-600",children:G(u.vendaChapas)})]})]})]}),Object.keys(u.chapasPorMaterial||{}).map(f=>{const d=h.find(O=>O.id===parseInt(f)),l=u.chapasPorMaterial[f],j=(d==null?void 0:d.custo)*l,m=((d==null?void 0:d.venda)||(d==null?void 0:d.custo))*l;return e.jsxs("div",{className:"flex justify-between text-sm text-slate-700 pl-4 py-2 hover:bg-slate-50 rounded",children:[e.jsxs("span",{className:"flex-1",children:[e.jsx("span",{className:"font-medium",children:d==null?void 0:d.nome}),e.jsxs("span",{className:"text-slate-500 ml-2",children:["(",l,"x chapas ‚Ä¢ ",d==null?void 0:d.comprimento,"x",d==null?void 0:d.altura,"mm ‚Ä¢",((d==null?void 0:d.comprimento)*(d==null?void 0:d.altura)/1e6*l).toFixed(2),"m¬≤ total)"]})]}),e.jsxs("div",{className:"flex gap-6 ml-4",children:[e.jsx("span",{className:"text-orange-600 w-24 text-right",children:G(j)}),e.jsx("span",{className:"text-green-600 w-24 text-right",children:G(m)})]})]},f)}),u.margemChapas>0&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-200 flex justify-between text-sm pl-4",children:[e.jsx("span",{className:"font-semibold text-slate-600",children:"Margem das Chapas:"}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[G(u.margemChapas)," (",(u.margemChapas/u.vendaChapas*100).toFixed(1),"%)"]})]}),u.detalhesChapas&&u.detalhesChapas.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[e.jsxs("h4",{className:"font-semibold text-slate-700 mb-3 flex items-center gap-2",children:["üìä Aproveitamento por Chapa",e.jsx("span",{className:"text-xs text-slate-500 font-normal",children:"(pe√ßas = pre√ßo venda, sobra = pre√ßo custo)"})]}),u.detalhesChapas.map((f,d)=>e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 mb-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"font-medium text-slate-800",children:["Chapa ",d+1," - ",f.materialNome]}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded font-medium ${f.percentualAproveitamento>=80?"bg-green-100 text-green-800":f.percentualAproveitamento>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[f.percentualAproveitamento.toFixed(1),"% aproveitamento"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-slate-600",children:[e.jsxs("div",{children:["üìè √Årea total: ",e.jsxs("strong",{children:[f.areaTotal.toFixed(2),"m¬≤"]})]}),e.jsxs("div",{children:["‚úÇÔ∏è √Årea pe√ßas: ",e.jsxs("strong",{children:[f.areaPecas.toFixed(2),"m¬≤"]})]}),e.jsxs("div",{children:["üî≤ √Årea sobra: ",e.jsxs("strong",{children:[f.areaSobra.toFixed(2),"m¬≤"]})]}),e.jsxs("div",{children:["üíµ Venda pe√ßas: ",e.jsx("strong",{className:"text-green-700",children:G(f.vendaPecas)})]}),e.jsxs("div",{children:["üí∞ Custo sobra: ",e.jsx("strong",{className:"text-orange-700",children:G(f.custoSobra)})]})]})]},d))]}),u.detalhesChapas&&u.detalhesChapas.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[e.jsx("h4",{className:"font-semibold text-slate-700 mb-3",children:"üìê Resumo de Metragem"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 border border-green-200",children:[e.jsx("div",{className:"text-xs text-green-700 font-medium mb-1",children:"Pe√ßas Cobradas"}),e.jsxs("div",{className:"text-xl font-bold text-green-800",children:[u.detalhesChapas.reduce((f,d)=>f+d.areaPecas,0).toFixed(2),"m¬≤"]}),e.jsx("div",{className:"text-xs text-green-600 mt-1",children:G(u.detalhesChapas.reduce((f,d)=>f+d.vendaPecas,0))})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 border border-orange-200",children:[e.jsx("div",{className:"text-xs text-orange-700 font-medium mb-1",children:"Sobra Cobrada"}),e.jsxs("div",{className:"text-xl font-bold text-orange-800",children:[u.detalhesChapas.reduce((f,d)=>f+d.areaSobra,0).toFixed(2),"m¬≤"]}),e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:[G(u.detalhesChapas.reduce((f,d)=>f+d.custoSobra,0))," (pre√ßo custo)"]})]}),e.jsxs("div",{className:"bg-slate-100 rounded-lg p-3 border border-slate-300",children:[e.jsx("div",{className:"text-xs text-slate-700 font-medium mb-1",children:"Total Geral"}),e.jsxs("div",{className:"text-xl font-bold text-slate-800",children:[u.detalhesChapas.reduce((f,d)=>f+d.areaTotal,0).toFixed(2),"m¬≤"]}),e.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:[(u.detalhesChapas.reduce((f,d)=>f+d.areaPecas,0)/u.detalhesChapas.reduce((f,d)=>f+d.areaTotal,0)*100).toFixed(1),"% aproveitamento"]})]})]})]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.acabamentos>0&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsx("div",{className:"text-sm text-blue-700 font-medium mb-1",children:"Total Acabamentos"}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:G(u.acabamentos)}),e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Ver detalhes em cada pe√ßa"})]}),u.recortes>0&&e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[e.jsx("div",{className:"text-sm text-purple-700 font-medium mb-1",children:"Total Recortes"}),e.jsx("div",{className:"text-2xl font-bold text-purple-800",children:G(u.recortes)}),e.jsx("div",{className:"text-xs text-purple-600 mt-1",children:"Ver detalhes em cada pe√ßa"})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex justify-between py-3 border-t-2 border-slate-400 bg-gradient-to-r from-slate-50 to-slate-100 px-4 rounded-lg",children:[e.jsx("span",{className:"text-lg font-bold text-slate-700",children:"CUSTO TOTAL"}),e.jsx("span",{className:"text-lg font-bold text-orange-600",children:G(u.custoTotal)})]}),e.jsxs("div",{className:"flex justify-between py-3 bg-gradient-to-r from-green-50 to-emerald-50 px-4 rounded-lg border-2 border-green-200",children:[e.jsx("span",{className:"text-xl font-bold text-slate-800",children:"VALOR DE VENDA"}),e.jsx("span",{className:"text-xl font-bold text-green-600",children:G(u.vendaTotal)})]}),u.margemTotal>0&&e.jsxs("div",{className:"flex justify-between py-3 bg-gradient-to-r from-blue-50 to-indigo-50 px-4 rounded-lg border-2 border-blue-200",children:[e.jsx("span",{className:"text-lg font-bold text-slate-800",children:"MARGEM DE LUCRO"}),e.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[G(u.margemTotal),e.jsxs("span",{className:"text-sm ml-2",children:["(",(u.margemTotal/u.vendaTotal*100).toFixed(1),"%)"]})]})]})]})]})},Yt=({chapa:s,numero:h,onMoverPeca:b,onMoverPecaNaChapa:u,onGirarPeca:f,pecaArrastando:d,setPecaArrastando:l,todasChapas:j})=>{const[m,O]=z.useState(.15),M=z.useRef(null),[a,y]=z.useState(null),[g,n]=z.useState({x:0,y:0}),[I,w]=z.useState(null),[r,D]=z.useState(null);z.useEffect(()=>{S()},[s,m,a,I]);const S=()=>{const N=M.current;if(!N)return;const c=N.getContext("2d"),$=s.material.comprimento*m,P=s.material.altura*m;N.width=$+100,N.height=P+100,c.fillStyle="#f9fafb",c.fillRect(50,50,$,P),c.strokeStyle="#374151",c.lineWidth=2,c.strokeRect(50,50,$,P),c.strokeStyle="#e5e7eb",c.lineWidth=.5;for(let p=0;p<=s.material.comprimento;p+=500){const C=50+p*m;c.beginPath(),c.moveTo(C,50),c.lineTo(C,50+P),c.stroke()}for(let p=0;p<=s.material.altura;p+=500){const C=50+p*m;c.beginPath(),c.moveTo(50,C),c.lineTo(50+$,C),c.stroke()}const K=["#3b82f6","#10b981","#8b5cf6","#f59e0b","#ef4444","#06b6d4","#ec4899","#14b8a6"];if(s.pecas.forEach((p,C)=>{if((a==null?void 0:a.id)===p.id)return;const x=50+p.posX*m,k=50+p.posY*m,R=(p.rotacao===90?p.altura:p.comprimento)*m,W=(p.rotacao===90?p.comprimento:p.altura)*m,ge=I===p.id,de=ge?"#10b981":K[C%K.length],me=parseInt(de.slice(1,3),16),le=parseInt(de.slice(3,5),16),A=parseInt(de.slice(5,7),16);c.fillStyle=`rgb(${me+(255-me)*.7}, ${le+(255-le)*.7}, ${A+(255-A)*.7})`,c.fillRect(x,k,R,W);const H=ge?2:1.5;if(c.strokeStyle=de,c.lineWidth=H,c.strokeRect(x+H/2,k+H/2,R-H,W-H),p.acabamentos){const pe={esquadria:"#ef4444",boleado:"#eab308",polimento:"#3b82f6",canal:"#f59e0b"},we=3*m;Object.keys(p.acabamentos).forEach(he=>{const oe=p.acabamentos[he];if(!oe||!oe.ativo||!oe.lados)return;const Me=pe[he],t=he==="canal"?we:0;c.strokeStyle=Me,c.lineWidth=2,c.setLineDash([4,2]),oe.lados.superior&&(c.beginPath(),c.moveTo(x+t,k+t),c.lineTo(x+R-t,k+t),c.stroke()),oe.lados.inferior&&(c.beginPath(),c.moveTo(x+t,k+W-t),c.lineTo(x+R-t,k+W-t),c.stroke()),oe.lados.esquerda&&(c.beginPath(),c.moveTo(x+t,k+t),c.lineTo(x+t,k+W-t),c.stroke()),oe.lados.direita&&(c.beginPath(),c.moveTo(x+R-t,k+t),c.lineTo(x+R-t,k+W-t),c.stroke()),c.setLineDash([])})}c.fillStyle=`rgb(${Math.max(0,me-40)}, ${Math.max(0,le-40)}, ${Math.max(0,A-40)})`,c.font="bold 10px Arial",c.textAlign="center";const Q=p.nome||`Pe√ßa #${C+1}`,xe=15,Ce=Q.length>xe?Q.substring(0,xe)+"...":Q;c.fillText(Ce,x+R/2,k+W/2-8),c.font="9px Arial";const ve=p.rotacao===90?`${p.altura}x${p.comprimento}`:`${p.comprimento}x${p.altura}`;c.fillText(ve,x+R/2,k+W/2+3),p.rotacao===90&&(c.font="bold 8px Arial",c.fillText("‚Üª 90¬∞",x+R/2,k+W/2+13))}),a){const p=(a.rotacao===90?a.altura:a.comprimento)*m,C=(a.rotacao===90?a.comprimento:a.altura)*m,x=a.colisao?"rgba(239, 68, 68, 0.7)":"rgba(59, 130, 246, 0.6)",k=a.colisao?"#dc2626":"#1e40af";c.fillStyle=x,c.fillRect(a.x,a.y,p,C),c.strokeStyle=k,c.lineWidth=2,c.setLineDash([5,5]),c.strokeRect(a.x,a.y,p,C),c.setLineDash([]),a.colisao&&(c.fillStyle="#ffffff",c.font="bold 10px Arial",c.textAlign="center",c.fillText("COLIS√ÉO!",a.x+p/2,a.y+C/2))}c.fillStyle="#374151",c.font="bold 14px Arial",c.textAlign="center",c.fillText(`${s.material.comprimento} mm`,50+$/2,35),c.save(),c.translate(35,50+P/2),c.rotate(-Math.PI/2),c.fillText(`${s.material.altura} mm`,0,0),c.restore()},E=N=>{const $=M.current.getBoundingClientRect(),P=N.clientX-$.left,K=N.clientY-$.top,p=s.pecas.find(C=>{const x=50+C.posX*m,k=50+C.posY*m,R=(C.rotacao===90?C.altura:C.comprimento)*m,W=(C.rotacao===90?C.comprimento:C.altura)*m;return P>=x&&P<=x+R&&K>=k&&K<=k+W});if(p){w(p.id);const C=50+p.posX*m,x=50+p.posY*m;n({x:P-C,y:K-x}),y({...p,x:C,y:x})}else w(null)},q=N=>{if(!a)return;const $=M.current.getBoundingClientRect(),P=N.clientX-$.left-g.x,K=N.clientY-$.top-g.y;let p=Math.max(0,(P-50)/m),C=Math.max(0,(K-50)/m);const x=4,k=20,R=a.rotacao===90?a.altura:a.comprimento,W=a.rotacao===90?a.comprimento:a.altura;Math.abs(p-x)<k&&(p=x),Math.abs(C-x)<k&&(C=x),Math.abs(p+R+x-s.material.comprimento)<k&&(p=s.material.comprimento-R-x),Math.abs(C+W+x-s.material.altura)<k&&(C=s.material.altura-W-x),s.pecas.forEach(A=>{if(A.id===a.id)return;const H=A.rotacao===90?A.altura:A.comprimento,Q=A.rotacao===90?A.comprimento:A.altura;Math.abs(p-(A.posX+H+x))<k&&!(C+W<A.posY||C>A.posY+Q)&&(p=A.posX+H+x),Math.abs(p+R+x-A.posX)<k&&!(C+W<A.posY||C>A.posY+Q)&&(p=A.posX-R-x),Math.abs(C-(A.posY+Q+x))<k&&!(p+R<A.posX||p>A.posX+H)&&(C=A.posY+Q+x),Math.abs(C+W+x-A.posY)<k&&!(p+R<A.posX||p>A.posX+H)&&(C=A.posY-W-x),Math.abs(C-A.posY)<k&&(C=A.posY),Math.abs(p-A.posX)<k&&(p=A.posX),Math.abs(C+W-(A.posY+Q))<k&&!(p+R<A.posX||p>A.posX+H)&&(C=A.posY+Q-W),Math.abs(p+R-(A.posX+H))<k&&!(C+W<A.posY||C>A.posY+Q)&&(p=A.posX+H-R)});const me=s.pecas.some(A=>{if(A.id===a.id)return!1;const H=A.rotacao===90?A.altura:A.comprimento,Q=A.rotacao===90?A.comprimento:A.altura,xe=p+R/2,Ce=C+W/2,ve=A.posX+H/2,pe=A.posY+Q/2,we=Math.abs(xe-ve),he=Math.abs(Ce-pe),oe=(R+H)/2+x,Me=(W+Q)/2+x;return we<oe&&he<Me}),le=p+R+x>s.material.comprimento||C+W+x>s.material.altura||p<x||C<x;y({...a,x:50+p*m,y:50+C*m,posXReal:p,posYReal:C,colisao:me||le})},v=N=>{if(!a)return;const c=a.posXReal!==void 0?a.posXReal:Math.max(0,Math.round((a.x-50)/m)),$=a.posYReal!==void 0?a.posYReal:Math.max(0,Math.round((a.y-50)/m)),P=4,K=a.rotacao===90?a.altura:a.comprimento,p=a.rotacao===90?a.comprimento:a.altura;if(!(c+K+P<=s.material.comprimento&&$+p+P<=s.material.altura&&c>=P&&$>=P)){alert("A pe√ßa n√£o cabe nesta posi√ß√£o! Verifique os limites da chapa."),y(null);return}if(s.pecas.some(k=>{if(k.id===a.id)return!1;const R=k.rotacao===90?k.altura:k.comprimento,W=k.rotacao===90?k.comprimento:k.altura,ge=c+K/2,de=$+p/2,me=k.posX+R/2,le=k.posY+W/2,A=Math.abs(ge-me),H=Math.abs(de-le),Q=(K+R)/2+P,xe=(p+W)/2+P;return A<Q&&H<xe})){alert("N√£o √© poss√≠vel posicionar a pe√ßa aqui! Ela precisa estar a pelo menos 4mm de dist√¢ncia das outras pe√ßas."),y(null);return}u(a.id,s.id,c,$),y(null)};return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg",children:["Chapa #",h]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.material.nome," - ",s.pecas.length," pe√ßas"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm",children:"Zoom:"}),e.jsx("input",{type:"range",min:"0.05",max:"0.3",step:"0.01",value:m,onChange:N=>O(parseFloat(N.target.value)),className:"w-32"})]})]}),e.jsx("div",{className:"overflow-auto bg-white border border-gray-300 rounded",children:e.jsx("canvas",{ref:M,onMouseDown:E,onMouseMove:q,onMouseUp:v,onMouseLeave:v,className:"cursor-move"})}),e.jsxs("div",{className:"flex items-center justify-between mt-2 flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600",children:"üñ±Ô∏è Arraste pe√ßas livremente. Magnetismo ativo (20mm): alinha com outras pe√ßas e bordas."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"üí° Dica: O magnetismo facilita o alinhamento, mas voc√™ pode posicionar livremente em qualquer lugar!"})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:I&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{f(I,s.id)},className:"flex items-center gap-1 bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700",children:[e.jsx("span",{className:"rotate-90 inline-block",children:"‚Üª"}),"Girar Pe√ßa (90¬∞)"]}),j&&j.length>1&&j.filter(N=>N.materialId===s.materialId&&N.id!==s.id).length>0&&e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>D(r?null:"abrir"),className:"flex items-center gap-1 bg-orange-600 text-white px-3 py-1 rounded text-sm hover:bg-orange-700",children:[e.jsx(Ft,{size:14}),"Mover para Outra Chapa"]}),r==="abrir"&&e.jsxs("div",{className:"absolute bottom-full mb-2 right-0 bg-white border border-gray-300 rounded shadow-lg p-2 z-10 min-w-[200px]",children:[e.jsx("p",{className:"text-xs font-semibold mb-2 text-gray-700",children:"Selecione a chapa de destino:"}),e.jsx("p",{className:"text-xs text-blue-600 mb-2",children:"‚ú® O sistema encontrar√° automaticamente a melhor posi√ß√£o dispon√≠vel"}),j.filter(N=>N.materialId===s.materialId&&N.id!==s.id).map((N,c)=>e.jsxs("button",{onClick:()=>{s.pecas.find(P=>P.id===I)&&(b(I,N.id),w(null),D(null))},className:"w-full text-left px-2 py-1 text-sm hover:bg-blue-50 rounded",children:["Chapa #",j.findIndex($=>$.id===N.id)+1," - ",N.material.nome]},N.id))]})]})]})})]})]})};function Bt(){const[s,h]=z.useState(!1);z.useEffect(()=>{h(Ke.isLogado())},[]);const b=()=>{Ke.logout(),h(!1)};return s?e.jsxs("div",{children:[e.jsx(Lt,{}),e.jsx("button",{onClick:b,className:"fixed bottom-4 right-4 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg transition-colors duration-200 flex items-center gap-2",children:"üö™ Sair"})]}):e.jsx(kt,{aoEntrar:()=>h(!0)})}Ve.createRoot(document.getElementById("root")).render(e.jsx(gt.StrictMode,{children:e.jsx(Bt,{})}));
//# sourceMappingURL=index-DmAa-7yk.js.map
